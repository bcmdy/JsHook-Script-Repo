name: ğŸš® åˆ é™¤æ—§çš„å·¥ä½œæµè¿è¡Œ
# è¯¥å·¥ä½œæµç”¨äºåˆ é™¤æ—§çš„å·¥ä½œæµè¿è¡Œï¼Œå¹¶ä¸”æ”¯æŒåˆ é™¤ç‰¹å®šçš„å·¥ä½œæµã€‚

on:
  workflow_dispatch:
    inputs:
      # è®¾ç½®è¦åˆ é™¤çš„å·¥ä½œæµè¿è¡Œçš„å¤©æ•°
      days:
        description: "â° è®¾ç½®è¦åˆ é™¤çš„å·¥ä½œæµè¿è¡Œçš„å¤©æ•°"
        required: true
        default: "30"

      # è®¾ç½®æ¯ä¸ªå·¥ä½œæµçš„ä¿ç•™æœ€å°è¿è¡Œæ•°
      minimum_runs:
        description: "ğŸ“Š è®¾ç½®æ¯ä¸ªå·¥ä½œæµçš„ä¿ç•™æœ€å°è¿è¡Œæ•°"
        required: true
        default: "6"

      # è®¾ç½®è¦åˆ é™¤çš„å·¥ä½œæµçš„åç§°æˆ–æ–‡ä»¶åã€‚å¦‚æœæœªè®¾ç½®ï¼Œåˆ™åˆ é™¤æ‰€æœ‰å·¥ä½œæµã€‚
      delete_workflow_pattern:
        description: "ğŸ“‹ è®¾ç½®è¦åˆ é™¤çš„å·¥ä½œæµçš„åç§°æˆ–æ–‡ä»¶åã€‚å¦‚æœæœªè®¾ç½®ï¼Œåˆ™åˆ é™¤æ‰€æœ‰å·¥ä½œæµã€‚"
        required: false

      # è®¾ç½®è¦åˆ é™¤çš„å·¥ä½œæµçš„çŠ¶æ€ï¼Œæ”¯æŒï¼šæ´»åŠ¨ã€å·²åˆ é™¤ã€å·²ç¦ç”¨åˆ†æ”¯ã€å·²ç¦ç”¨æ— æ´»åŠ¨ã€å·²ç¦ç”¨æ‰‹åŠ¨
      delete_workflow_by_state_pattern:
        description: "ğŸ“ è®¾ç½®è¦åˆ é™¤çš„å·¥ä½œæµçš„çŠ¶æ€ï¼Œæ”¯æŒï¼šæ´»åŠ¨ã€å·²åˆ é™¤ã€å·²ç¦ç”¨åˆ†æ”¯ã€å·²ç¦ç”¨æ— æ´»åŠ¨ã€å·²ç¦ç”¨æ‰‹åŠ¨"
        required: true
        default: "All"
        type: choice
        options:
          - "All"
          - active
          - deleted
          - disabled_fork
          - disabled_inactivity
          - disabled_manually

      # è®¾ç½®è¦åˆ é™¤çš„å·¥ä½œæµè¿è¡Œçš„ç»“è®ºï¼Œæ”¯æŒï¼šéœ€è¦æ“ä½œã€å–æ¶ˆã€å¤±è´¥ã€è·³è¿‡ã€æˆåŠŸ
      delete_run_by_conclusion_pattern:
        description: "ğŸ“ˆ è®¾ç½®è¦åˆ é™¤çš„å·¥ä½œæµè¿è¡Œçš„ç»“è®ºï¼Œæ”¯æŒï¼šéœ€è¦æ“ä½œã€å–æ¶ˆã€å¤±è´¥ã€è·³è¿‡ã€æˆåŠŸ"
        required: true
        default: "All"
        type: choice
        options:
          - "All"
          - action_required
          - cancelled
          - failure
          - skipped
          - success

      # è®¾ç½®æ˜¯å¦ä»…è®°å½•æ“ä½œï¼Œä¸æ‰§è¡Œä»»ä½•åˆ é™¤æ“ä½œã€‚
      dry_run:
        description: "ğŸ“ è®¾ç½®æ˜¯å¦ä»…è®°å½•æ“ä½œï¼Œä¸æ‰§è¡Œä»»ä½•åˆ é™¤æ“ä½œã€‚"
        required: false

jobs:
  del_runs:
    runs-on: ubuntu-latest
    permissions:
      actions: write
    steps:
      - name: ğŸš® åˆ é™¤å·¥ä½œæµè¿è¡Œ
        uses: Mattraks/delete-workflow-runs@v2
        with:
          token: ${{ github.token }}
          repository: ${{ github.repository }}
          retain_days: ${{ github.event.inputs.days }}
          keep_minimum_runs: ${{ github.event.inputs.minimum_runs }}
          delete_workflow_pattern: ${{ github.event.inputs.delete_workflow_pattern }}
          delete_workflow_by_state_pattern: ${{ github.event.inputs.delete_workflow_by_state_pattern }}
          delete_run_by_conclusion_pattern: ${{ github.event.inputs.delete_run_by_conclusion_pattern }}
          dry_run: ${{ github.event.inputs.dry_run }}
